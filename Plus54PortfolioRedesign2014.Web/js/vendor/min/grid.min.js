var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(i,t){var e=this,n=arguments,s=function(){i.type="debouncedresize",$event.dispatch.apply(e,n)};resizeTimeout&&clearTimeout(resizeTimeout),t?s():resizeTimeout=setTimeout(s,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(i){function t(){var t=$(r),e=$(d);s&&(d.length?s.reject(o,t,e):s.resolve(o)),$.isFunction(i)&&i.call(n,o,t,e)}function e(i,e){i.src!==BLANK&&-1===$.inArray(i,h)&&(h.push(i),e?d.push(i):r.push(i),$.data(i,"imagesLoaded",{isBroken:e,src:i.src}),a&&s.notifyWith($(i),[e,o,$(r),$(d)]),o.length===h.length&&(setTimeout(t),o.unbind(".imagesLoaded")))}var n=this,s=$.isFunction($.Deferred)?$.Deferred():0,a=$.isFunction(s.notify),o=n.find("img").add(n.filter("img")),h=[],r=[],d=[];return $.isPlainObject(i)&&$.each(i,function(t,e){"callback"===t?i=e:s&&s[t](e)}),o.length?o.bind("load.imagesLoaded error.imagesLoaded",function(i){e(i.target,"error"===i.type)}).each(function(i,t){var n=t.src,s=$.data(t,"imagesLoaded");return s&&s.src===n?(e(t,s.isBroken),void 0):t.complete&&void 0!==t.naturalWidth?(e(t,0===t.naturalWidth||0===t.naturalHeight),void 0):((t.readyState||t.complete)&&(t.src=BLANK,t.src=n),void 0)}):t(),s?s.promise(n):n};var Grid=function(){function i(i){A=$.extend(!0,{},A,i),l.imagesLoaded(function(){e(!0),a(),n()})}function t(i){c=c.add(i),i.each(function(){var i=$(this);i.data({offsetTop:i.offset().top,height:i.height()})}),s(i)}function e(i){c.each(function(){var t=$(this);t.data("offsetTop",t.offset().top),i&&t.data("height",t.height())})}function n(){s(c),v.on("debouncedresize",function(){f=0,p=-1,e(),a();var i=$.data(this,"preview");"undefined"!=typeof i&&h()})}function s(i){i.on("click","span.og-close",function(){return h(),!1}).children("a").on("click",function(){var i=$(this).parent();return g===i.index()?h():o(i),!1})}function a(){d={width:v.width(),height:v.height()}}function o(i){var t=$.data(this,"preview"),e=i.data("offsetTop");if(f=0,"undefined"!=typeof t){if(p===e)return t.update(i),!1;e>p&&(f=t.height),h()}p=e,t=$.data(this,"preview",new r(i)),t.open()}function h(){g=-1;var i=$.data(this,"preview");i.close(),$.removeData(this,"preview")}function r(i){this.$item=i,this.expandedIdx=this.$item.index(),this.create(),this.update()}var d,l=$("#og-grid"),c=l.children("li"),g=-1,p=-1,f=0,m=10,v=$(window),u=$("html, body"),y={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},w=y[Modernizr.prefixed("transition")],x=Modernizr.csstransitions,A={minHeight:900,speed:350,easing:"ease"};return r.prototype={create:function(){this.$closePreview=$('<span class="og-close"></span>'),this.$title=$("<h3></h3>"),this.$category=$('<span class="category"></span>'),this.$headcontent=$('<div class="head-conent"></div>').append(this.$title,this.$category),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$description=$("<p></p>"),this.$technologies=$("<p></p>"),this.$integration=$("<p></p>"),this.$description=$("<p></p>"),this.$technologiesBox=$('<div class="technology"><h5>Technology</h5></div>').append(this.$technologies),this.$integrationBox=$('<div class="integration"><h5>Social integration</h5></div>').append(this.$integration),this.$detailcontent=$('<div class="detail-content"></div>').append("<h4>Overview</h4>",this.$description,this.$technologiesBox,this.$integrationBox),this.$href=$('<a href="#" target="_blank"></a>'),this.$sitename=$('<p class="sitename"></p>').append(this.$href),this.$partner=$("<span></span>"),this.$year=$("<span></span>"),this.$clientlogo=$("<div></div>"),this.$partnerBox=$("<p>Partner: </p>").append(this.$partner),this.$yearBox=$("<p>Year: </p>").append(this.$year),this.$clientlogoBox=$('<div class="clientlogo"><h5>Client</h5></div>').append(this.$clientlogo),this.$moreinfo=$('<div class="moreinfo"><h5>More Info</h5></div>').append(this.$sitename,this.$partnerBox,this.$yearBox,this.$clientlogoBox),this.$details=$('<div class="og-details"></div>').append(this.$detailcontent,this.$moreinfo),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$closePreview,this.$headcontent,this.$fullimage,this.$details),this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner),this.$item.append(this.getEl()),x&&this.setTransition()},update:function(i){if(i&&(this.$item=i),-1!==g){var t=c.eq(g);t.removeClass("og-expanded"),$("#og-grid li").removeClass("inactive"),this.$item.addClass("og-expanded"),this.$item.siblings().addClass("inactive"),this.positionPreview()}g=this.$item.index();var e=this.$item.find("a").attr("href"),n=this.$item.children("a"),s={title:n.data("title"),category:n.data("category"),description:n.data("description"),technologies:n.data("technologies"),integration:n.data("integration"),href:n.attr("href"),partner:n.data("partner"),year:n.data("year"),clientlogo:n.data("clientlogo"),largesrc:n.data("largesrc")};this.$title.html(s.title),this.$category.html(s.category),this.$description.html(s.description),this.$technologies.html(s.technologies),this.$integration.html(s.integration),this.$href.attr("href",s.href),this.$sitename.html('<a href="'+s.href+'" target="_blank">'+e+"</a>"),this.$partner.html(s.partner),this.$year.html(s.year),this.$clientlogo.html(s.clientlogo);var a=this;"undefined"!=typeof a.$largeImg&&a.$largeImg.remove(),a.$fullimage.is(":visible")&&(this.$loading.show(),$("<img/>").load(function(){var i=$(this);i.attr("src")===a.$item.children("a").data("largesrc")&&(a.$loading.hide(),a.$fullimage.find("img").remove(),a.$largeImg=i.fadeIn(350),a.$fullimage.append(a.$largeImg))}).attr("src",s.largesrc))},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var i=this,t=function(){x&&$(this).off(w),i.$item.removeClass("og-expanded"),i.$item.siblings().removeClass("inactive"),i.$previewEl.remove()};return setTimeout($.proxy(function(){"undefined"!=typeof this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var i=c.eq(this.expandedIdx);i.css("height",i.data("height")).on(w,t),x||t.call()},this),25),!1},calcHeight:function(){var i=d.height-this.$item.data("height")-m,t=d.height;i<A.minHeight&&(i=A.minHeight,t=A.minHeight+this.$item.data("height")+m),this.height=i,this.itemHeight=t},setHeights:function(){var i=this,t=function(){x&&i.$item.off(w),i.$item.addClass("og-expanded"),i.$item.siblings().addClass("inactive")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(w,t),x||t.call()},positionPreview:function(){var i=this.$item.data("offsetTop"),t=this.$previewEl.offset().top-f,e=this.height+this.$item.data("height")+m<=d.height?i:this.height<d.height?t-(d.height-this.height):t;u.animate({scrollTop:e},A.speed)},setTransition:function(){this.$previewEl.css("transition","height "+A.speed+"ms "+A.easing),this.$item.css("transition","height "+A.speed+"ms "+A.easing)},getEl:function(){return this.$previewEl}},{init:i,addItems:t}}();